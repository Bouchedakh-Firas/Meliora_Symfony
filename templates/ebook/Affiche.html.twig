{% extends 'base.html.twig' %}

{% block title %}Consuleter les E-books!{% endblock %}







{% block body %}


<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">
</script>
<script>
$( document ).ready(function() {
        $("#search").keyup(function(e){
/* La variable value va prendre la valeur insérer dans le champ de texte afin d’effectuer la recherche */
          var value = $(this).val();
/* Ajax est lancé lors du remplissage du champ texte dont l’id est « search » pour faire la recherche */
             $.ajax({
/* l’url est une chaine de caractères contenant l’adresse où la requête est envoyée */
                url : "{{ path('searchbookx') }}",
/* La méthode utilisée pour transférer les données est GET */
                type : 'GET', 
/*Ici search value va prendre la chaine entrée par un utilisateur dans la zone de recherche et sera placée après l’url */                
                data: {
                        'searchValue' : value
                    },
/*Cette fonction permet de vider le contenu du tableau pour recevoir le nouveau contenu*/
                success : function(retour){
                  if(retour){
  			$('#t tbody#search').empty();
  			$.each(JSON.parse(retour), function(i, obj) {
  			$('#t tbody#all').hide();
  			$('#t tbody#search').append('<tr><td> '+obj.id+'  </td><td>    '+obj.auteur+'  </td><td>'+obj.genre+' </td><td>'+obj.favoris+'</td><td>'+obj.titre+'</td><td>'+obj.evaluation+'</td><td><a href="/d'+obj.id+'"><button type="button" class="btn btn-danger">Delete</button><a/><a href="/u'+obj.id+'"><button type="button" class="btn btn-light">Update</button><a/></td></tr>');
});
                  }
                  else
                  {
   $('#t tbody#all').show();
   $('#t tbody#search').empty();
   $('#t tbody#search').fadeIn('fast');
                     }
 },
        });
        return false;
        });
    });
        </script>


  
<input type="text" id="search" class="form-control" placeholder="Search">
<br>
<div name='container'>
<table class="table table-hover table-bordered " data-toggle="table" data-search="true" id="t">
<thead class="thead-dark">
<tr>
<th data-sortable="true" data-field="id">Numero Ebook</th>
<th  data-sortable="true" data-field="auteur">AUTEUR</th>
<th  data-sortable="true" data-field="genre">GENRE</th>
<th  data-sortable="true" data-field="text">FAVORIS</th>
<th  data-sortable="true" data-field="text">TITRE</th>
<th  data-sortable="true" data-field="text">EVALUATION</th>
<th  data-sortable="true" data-field="text">img</th>
<th data-sortable="true">Action</th>

</tr>
</thead>

<tbody id="all">
<tr {% for b in ebooks  %}>
<th>{{b.id}}</th>
<th>{{b.auteur}}</th>
<th>{{b.genre}}</th>
<th>{{b.favoris}}</th>
<th>{{b.titre}}</th>
<th>{{b.evaluation}}</th>
<th><img src="/img/imgapp/{{b.image}}" width="200" height="200" /></th>

<th><a href="{{ path('d',{'id':b.id})}}"><button type="button" class="btn btn-danger">Delete</button><a/><a href="{{ path('u',{'id':b.id})}}"><button type="button" class="btn btn-light">Update</button><a/></th>
</tr{% endfor %}>
</tbody>
<tbody id="search">
</tbody>
</table>
</div>
<div name ="add">
<center>

<a href="{{ path('Addb')}}">
<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
  ajouter livre
</button><a/>

<a href="{{ path('exe')}}">
<button type="button" >
 <img src="/img/imgapp/microsoft-excel-2-569282.png" width="110" height="30" />
</button>
<a href="{{ path('pdf1')}}">
<button type="button" >
 <img src="/img/imgapp/PDF_file_icon" width="110" height="30" />
</button>

</center>
</div>









{% endblock %}