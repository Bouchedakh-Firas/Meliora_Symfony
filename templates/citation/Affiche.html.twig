{% extends 'base.html.twig' %}

{% block title %}Consuleter les citations!{% endblock %}

{% block body %}


<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">
</script>
<script>
$( document ).ready(function() {
        $("#search").keyup(function(e){
/* La variable value va prendre la valeur insérer dans le champ de texte afin d’effectuer la recherche */
          var value = $(this).val();
/* Ajax est lancé lors du remplissage du champ texte dont l’id est « search » pour faire la recherche */
             $.ajax({
/* l’url est une chaine de caractères contenant l’adresse où la requête est envoyée */
                url : "{{ path('searchcx') }}",
/* La méthode utilisée pour transférer les données est GET */
                type : 'GET', 
/*Ici search value va prendre la chaine entrée par un utilisateur dans la zone de recherche et sera placée après l’url */                
                data: {
                        'searchValue' : value
                    },
/*Cette fonction permet de vider le contenu du tableau pour recevoir le nouveau contenu*/
                success : function(retour){
                  if(retour){
  			$('#t tbody#search').empty();
  			$.each(JSON.parse(retour), function(i, obj) {
  			$('#t tbody#all').hide();
  			$('#t tbody#search').append('<tr><td> '+obj.id+'  </td><td>    '+obj.auteur+'  </td><td>'+obj.text+' </td><td>'+obj.genre+'</td><td>'+obj.liker+'</td><td>'+obj.disliker+'</td><td><a href="/de'+obj.id+'"><button type="button" class="btn btn-danger">Delete</button><a/><a href="/uc'+obj.id+'"><button type="button" class="btn btn-light">Update</button><a/></td></tr>');
});
                  }
                  else
                  {
   $('#t tbody#all').show();
   $('#t tbody#search').empty();
   $('#t tbody#search').fadeIn('fast');
                     }
 },
        });
        return false;
        });
    });
        </script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">

<body>  
<input type="text" id="search" class="form-control" placeholder="Search">
<div name='container'>
<table class="table table-hover table-bordered " data-toggle="table" data-search="true" id="t">
<thead class="thead-dark">
<tr>
<th data-sortable="true" data-field="id">Numero citation</th>
<th  data-sortable="true" data-field="auteur">AUTEUR</th>
<th  data-sortable="true" data-field="text">CONTENU</th>
<th  data-sortable="true" data-field="genre">GENRE</th>
<th  data-sortable="true" data-field="genre">like</th>
<th  data-sortable="true" data-field="genre">dislike</th>
<th data-sortable="true">Action</th>
</tr>
</thead>
<tbody id="all">
<tr {% for c in citations  %}>
<th>{{c.id}}</th>
<th>{{c.auteur}}</th>
<th>{{c.text}}</th>
<th>{{c.genre}}</th>
<th><center>{{c.liker}}</center><br><a href="{{ path('like',{'id':c.id})}}"><button><img src="/img/imgapp/Hand thumbs up like 2.png" width="50" height="50" /></button></a></th>
<th><center>{{c.disliker}}</center><br><a href="{{ path('dislike',{'id':c.id})}}"><button><img src="/img/imgapp/Graphicloads-Flat-Finance-Dislike.ico" width="50" height="50" /></button></th>
<th><a href="{{ path('de',{'id':c.id})}}"><button type="button" class="btn btn-danger">Delete</button><a/>    <a href="{{ path('uc',{'id':c.id})}}"><button type="button" class="btn btn-light">Update</button><a/></th>
</tr{% endfor %}>
</tbody>
<tbody id="search"></tbody>
</table>
</div>
<div name ="add">
<center>
<a href="{{ path('Add')}}">
<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
  ajouter citations
</button><a/>
<div name="modal add"></div>
</center>
</div>


{% endblock %}