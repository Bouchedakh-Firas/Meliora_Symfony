/*!
 * Scamp Player ver. 4.1.3.4
 * jQuery SoundManager 2 Plugin
 *
 * Copyright (c) 2019 Mariusz Rek
 * Rascals Themes 2019
 *
 */
(function(t){t.ScampPlayer=function(s,e){function n(s,e){''==e&&(e='80'),t.SHOUTcast({host:s,port:e}).stats(function(){this.onAir()?t('#scamp_player .sp-track-container .sp-track-title').text(this.get('songtitle')):t('#scamp_player .sp-track-container .sp-track-title').text(this.get('status'))})}function a(t){if(c.settings.enable_analyser&&c.settings.sound&&!1==c.settings.mobile){if(c.settings.v.comp=new RegExp(location.host),c.settings.v.audio=c.settings.sound._a,!c.settings.v.comp.test(c.settings.v.audio.src))return;if(('pause'==t||'stop'==t)&&'running'===c.settings.v.actx.state)return c.settings.v.actx.suspend(),void c.settings.audioAnalyser.call(this,{v:c.settings.v,status:'stop'});if('play'==t&&'suspended'===c.settings.v.actx.state)return c.settings.v.actx.resume(),void c.settings.audioAnalyser.call(this,{v:c.settings.v,status:'play'});if('update'==t&&'running'===c.settings.v.actx.state)return void c.settings.audioAnalyser.call(this,{v:c.settings.v,status:'update'});'init'==t&&(c.settings.v.actx=new(window.AudioContext||window.webkitAudioContext),c.settings.v.analyser=c.settings.v.actx.createAnalyser(),c.settings.v.audio.controls=!0,c.settings.v.audio.crossOrigin='anonymous',c.settings.v.audioSrc=c.settings.v.actx.createMediaElementSource(c.settings.v.audio),c.settings.v.audioSrc.connect(c.settings.v.analyser),c.settings.v.analyser.connect(c.settings.v.actx.destination),c.settings.v.frequencyData=new Uint8Array(c.settings.v.analyser.frequencyBinCount),c.settings.v.audioContentSrc=!0==c.settings.base64?Base64.encode(c.settings.v.audio.src):c.settings.v.audio.src,c.settings.audioAnalyser.call(this,{v:c.settings.v,status:'init'}))}}var r=Math.max,o=Math.min,l=Math.floor,d={sm_options:{},queue:null,volume_user:80,volume:100,shoutcast_interval:2e4,shoutcast_timer:!1,shoutcast:!0,is_shoutcast:!1,autoplay:!1,autoplay_storage:!0,loop:!1,random:!1,titlebar:!1,no_track_image:null,delay:5,path:null,load_first_track:!0,client_id:'23f5c38e0aa354cdd0e1a6b4286f6aa4',debug:!1,local_storage:!1,link_filter:'.track-title',player_content:'',enable_analyser:!1,base64:!1,obj:{status:'ready',action:'',tracks:[],tracks_size:0,track_nr:-1},storage_play:!1,v:{render_frame_eq:null,status:null,audio:null,actx:null,comp:null,analyser:null,audioSrc:null,frequencyData:null},play_from_list:!1,mobile:!1,status:null,soundcloud:!1,replace_sc_covers:!0,track_id:0,new_tracks_nr:0,new_tracks_notifications:!1,sm_init:!1,rebuild:!1,sound:null,track:null,searching:!1,tracklist_length:null,document_title:document.title,track_html:null,tracklist:null,is_mouse:!1,direction:'next',onReady:function(){},onTrackEnd:function(){},onTrackStart:function(){},audioAnalyser:function(){}},c=this;c.settings={};_has_touch=function(){return'ontouchstart'in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints},_remove_tracks=function(s){t('#'+s).find('.track').each(function(){var s=t(this).attr('href'),e=t('#sp-queue-scroll .sp-track-control[href="'+s+'"]'),a=t('#sp-queue-scroll .sp-track[data-sc="'+s+'"]');e.length&&e.parents('.sp-track').remove(),a&&a.remove()})},_check_tracks=function(s){if(0>=t('#sp-queue-scroll .fromlist[data-fromlist="'+s+'"]').length)return!1;var e=t('#'+s).find('.sp-track-item .track').length,a=t('#sp-queue-scroll .fromlist[data-fromlist="'+s+'"]').length;return!(e!=a)},_get_track_index=function(){var s,e=c.settings.track.find('.sp-track-control').attr('href');return track_from_queue=t('#sp-queue-scroll').find('.sp-track-control[href="'+e+'"]'),s=track_from_queue.parents('tr[class*="sp-track"]').index(),s};var g=function(s,e){'undefined'==typeof e&&(e=0),'undefined'==typeof s&&(s='play');var r=c.settings.track.find('.sp-track-control').attr('href'),o=document.createElement('a');!0==c.settings.base64&&(r=Base64.decode(r)),o.href=r,clearInterval(c.settings.shoutcast_timer),0<=r.indexOf('?sp_radio')?(t('#scamp_player').addClass('is-shoutcast'),e=0,c.settings.is_shoutcast=!0,c.settings.shoutcast&&(0<=r.indexOf('listen.radionomy')||0<=r.indexOf('&onair=0')||(c.settings.shoutcast_timer=setInterval(function(){n(o.hostname,o.port)},c.settings.shoutcast_interval),n(o.hostname,o.port)))):(t('#scamp_player').removeClass('is-shoutcast'),c.settings.is_shoutcast=!1),c.settings.sound=soundManager.createSound({id:'scamp_sound',url:r,from:e,stream:!0,autoload:!1,volume:c.settings.volume,onerror:function(s,e){console.log(this.id+' failed?',s,e),c.settings.track.addClass('sp-error'),c.update_content('error'),t('#sp-queue-scroll .sp-track:not(.sp-error)').length?'prev'==c.settings.direction?k():p():_()},onload:function(){c.update_content('loading'),a('init')},onplay:function(){var s={title:c.settings.track.find('.sp-title-button').text(),url:c.settings.track.find('.sp-track-control').attr('href'),artist:c.settings.track.find('.sp-artist-button').text(),track_index:_get_track_index(),tracklist_length:c.settings.tracklist_length};c.settings.onTrackStart.call(this,s),c.settings.track.addClass('loading'),c.el.addClass('loading'),c.update_content('loading'),t('#scamp_player').removeClass('sp-muted'),c.settings.sound&&0==c.settings.volume&&(c.settings.volume=c.settings.volume_user,c.settings.sound.setVolume(c.settings.volume),t('.sp-volume-position').css('width',c.settings.volume+'%')),t('#sp-queue-scroll tbody .paused').removeClass('paused'),t('.sp-volume-position').css('width',c.settings.volume+'%'),c.settings.sound.setVolume(c.settings.volume)},onpause:function(){c.update_content('pause'),a('pause'),c.settings.searching||(c.settings.track.removeClass('playing').addClass('paused'),c.el.removeClass('playing').addClass('paused'))},onresume:function(){c.update_content('play'),a('play'),c.settings.track.removeClass('paused').addClass('playing'),c.el.removeClass('paused').addClass('playing')},onstop:function(){c.settings.sound.setPosition(0),clearInterval(c.settings.shoutcast_timer),c.update_content('stop'),a('stop'),c.settings.track.removeClass('playing loading paused'),c.el.removeClass('playing loading paused'),t('.sp-time-elapsed, .sp-time-total').empty(),t('.sp-progress').find('.sp-position').width(0)},onfinish:function(){clearInterval(c.settings.shoutcast_timer);var s={title:c.settings.track.find('.sp-title-button').text(),url:c.settings.track.find('.sp-track-control').attr('href'),artist:c.settings.track.find('.sp-artist-button').text(),track_index:_get_track_index(),tracklist_length:c.settings.tracklist_length};if(c.settings.onTrackEnd.call(this,s),t('.sp-time-elapsed, .sp-time-total').empty(),t('.sp-progress').find('.sp-position').width(0),c.update_content('stop'),a('stop'),c.settings.track.removeClass('loading paused'),c.el.removeClass('loading paused'),c.settings.random)return u(),!1;if(c.settings.loop)p();else{var e=_get_track_index();e==c.settings.tracklist_length?(c.settings.track.removeClass('playing'),c.el.removeClass('playing')):p()}},whileloading:function(){t('.sp-progress').find('.sp-loading').width(100*(c.settings.sound.bytesLoaded/c.settings.sound.bytesTotal)+'%')},whileplaying:function(){if(c.settings.track.removeClass('paused loading').addClass('playing'),c.el.removeClass('paused loading').addClass('playing'),0==c.settings.sound.position?c.update_content('loading'):t('#scamp_player').is('.is_shoutcast, .sp-muted')?c.update_content('pause'):c.update_content('play'),'undefined'!=typeof Storage&&sessionStorage.setItem('scamp_player_pos',c.settings.sound.position),t('.sp-progress').find('.sp-position').width(100*(c.settings.sound.position/c.settings.sound.durationEstimate)+'%'),t('.sp-time-elapsed').html(_format_time(c.settings.sound.position)),t('.sp-time-total').html(_format_time(c.settings.sound.durationEstimate)),!c.settings.is_shoutcast&&!c.settings.mobile&&c.settings.sound.position>=c.settings.sound.durationEstimate){clearInterval(c.settings.shoutcast_timer);var s={title:c.settings.track.find('.sp-title-button').text(),url:c.settings.track.find('.sp-track-control').attr('href'),artist:c.settings.track.find('.sp-artist-button').text(),track_index:_get_track_index(),tracklist_length:c.settings.tracklist_length};if(c.settings.onTrackEnd.call(this,s),t('.sp-time-elapsed, .sp-time-total').empty(),t('.sp-progress').find('.sp-position').width(0),c.update_content('stop'),a('stop'),c.settings.track.removeClass('loading paused'),c.el.removeClass('loading paused'),c.settings.random)return u(),!1;if(c.settings.loop)p();else{var e=_get_track_index();e==c.settings.tracklist_length?(c.settings.track.removeClass('playing'),c.el.removeClass('playing')):p()}}}}),c.settings.load_first_track&&!1==c.settings.local_storage||'pause'===s?c.settings.load_first_track=!1:('play'===s&&(c.settings.load_first_track=!1),c.settings.sound.togglePause()),f()};_pause=function(){c.settings.sound&&c.settings.track.hasClass('playing')&&c.settings.sound.pause()},_play=function(){if('undefined'!=typeof event&&(t(event.target).hasClass('sp-play-button')||t(event.target).hasClass('sp-track-control'))&&(c.settings.storage_play=!1),null!=c.settings.tracklist_length){if(null==c.settings.track&&(c.settings.track=t('#sp-queue-scroll tbody tr:eq(0)')),c.settings.sound?c.settings.is_shoutcast?t('#scamp_player').hasClass('playing')||t('#scamp_player').hasClass('paused')?m():(_destruct_sound(),g()):c.settings.sound.togglePause():g(),c.settings.titlebar&&(document.title=c.settings.track.find('.sp-title-button').text()+' | '+c.settings.document_title),'undefined'!=typeof Storage){var s=function(){if(null!=c.settings.track&&(c.settings.track.hasClass('playing')||c.settings.track.hasClass('paused'))){var e=t('#sp-queue-scroll tbody').html();sessionStorage.setItem('scamp_player_list',e)}else setTimeout(s,400)};s()}'undefined'!=typeof event&&event.preventDefault()}};var u=function(){function s(t,s){return l(Math.random()*(s-t+1))+t}if(null==c.settings.tracklist_length||2>c.settings.tracklist_length)return c.settings.track=a,_play(),!1;for(var e=_get_track_index(),a=null,n=null;(n=s(0,c.settings.tracklist_length))==e;);return c.settings.track.removeClass('playing'),c.el.removeClass('playing'),a=t('#sp-queue-scroll tbody tr:eq('+n+')'),_destruct_sound(),c.settings.track=a,_play(),c.settings.sound&&c.settings.sound.setPosition(0),!0},p=function(){if(c.settings.direction='next',c.settings.storage_play=!1,null!=c.settings.tracklist_length){var s=_get_track_index(),e=s+1,a=null;return e>c.settings.tracklist_length&&(e=0),_destruct_sound(),a=t('#sp-queue-scroll tbody tr:eq('+e+')'),c.settings.track=a,_play(),c.settings.sound&&c.settings.sound.setPosition(0),!1}},k=function(){if(c.settings.direction='prev',c.settings.storage_play=!1,null!=c.settings.tracklist_length){var s=_get_track_index(),e=s-1,a=null;return 0>e&&(e=c.settings.tracklist_length),_destruct_sound(),a=t('#sp-queue-scroll tbody tr:eq('+e+')'),c.settings.track=a,_play(),c.settings.sound&&c.settings.sound.setPosition(0),!1}},_=function(){if(c.settings.storage_play=!1,null!=c.settings.tracklist_length)return null==c.settings.track&&(c.settings.track=t('#sp-queue-scroll tbody tr:eq(0)')),c.settings.sound&&c.settings.sound.stop(),!1},m=function(){if(c.settings.sound){var s=c.settings.track.find('.sp-track-control').attr('href'),e=t('a.sp-play-track[href="'+s+'"]');t('a.sp-play-track').removeClass('sp-play sp-pause sp-stop sp-loading sp-muted'),0==c.settings.volume?(c.settings.volume=c.settings.volume_user,c.settings.sound.setVolume(c.settings.volume),t('.sp-volume-position').css('width',c.settings.volume+'%'),e.addClass('sp-play'),t('#scamp_player').removeClass('sp-muted')):(c.settings.volume_user=c.settings.volume,c.settings.volume=0,c.settings.sound.setVolume(0),t('.sp-volume-position').css('width','0'),e.addClass('sp-pause'),t('#scamp_player').addClass('sp-muted'))}},f=function(){if(t('.sp-track-container a',c.el).removeAttr('href').removeAttr('target'),t('.sp-track-container .sp-track-title, .sp-track-container .sp-track-artist',c.el).text(''),t('.sp-track-container .sp-track-artwork',c.el).attr('src',c.settings.no_track_image),t('.sp-marquee',c.el).text(''),c.settings.sound){var s=c.settings.track.find('.sp-cover-artwork img').attr('src'),e=c.settings.track.find('.sp-title-button').text(),a=c.settings.track.find('.sp-artist-button').text(),n=c.settings.track.find('.sp-artist-button').attr('href'),r=c.settings.track.find('.sp-artist-button').attr('target'),o=c.settings.track.find('.sp-title-button').attr('href'),l=c.settings.track.find('.sp-title-button').attr('target');shop_url=c.settings.track.find('.sp-tl-shop').attr('href'),shop_target=c.settings.track.find('.sp-tl-shop').attr('target'),''!==a&&''!==n&&(t('.sp-track-container .sp-track-artist',c.el).attr('href',n),r=''===r?'_self':r,t('.sp-track-container .sp-track-artist',c.el).attr('target',r)),''!==o&&(t('.sp-track-container .sp-track-title',c.el).attr('href',o),l=''===l?'_self':l,t('.sp-track-container .sp-track-title',c.el).attr('target',l)),t('.sp-track-container .sp-track-artwork',c.el).attr('src',s),t('.sp-track-container .sp-track-title',c.el).text(e),t('.sp-track-container .sp-track-artist',c.el).text(a);var d='<strong>'+e+'</strong>';''!==a&&(d=d+' - '+a),t('.sp-marquee',c.el).html(d)}return!1};_destruct_sound=function(){c.settings.sound&&(c.settings.sound.stop(),c.settings.sound.setPosition(0),c.settings.sound.destruct(),c.settings.sound=null,f())};var h=function(){c.settings.obj.track_nr++,0==c.settings.obj.track_nr&&1<c.settings.obj.tracks_size&&(setTimeout(function(){c.el.addClass('sp-queue-loading')},500),t('.sp-queue').css('opacity',0)),c.settings.obj.track_nr>=c.settings.obj.tracks_size?b():setTimeout(v,c.settings.delay)},b=function(){var s=null,e=null,a=null;if(0<t('#sp-scroller tr').length&&c.settings.rebuild?(1<c.settings.obj.tracks_size&&(setTimeout(function(){c.el.removeClass('sp-queue-loading')},500),t('.sp-queue').css('opacity',1)),c.settings.rebuild=!1,c.settings.new_tracks_notifications&&(t('.sp-badge',c.el).text('+'+c.settings.new_tracks_nr),'+0'!=t('.sp-badge',c.el).text()&&(t('.sp-badge',c.el).addClass('sp-show-badge'),setTimeout(function(){t('.sp-badge',c.el).removeClass('sp-show-badge')},5e3))),c.settings.new_tracks_nr=0):1<c.settings.obj.tracks_size&&(setTimeout(function(){c.el.removeClass('sp-queue-loading')},500),t('.sp-queue').css('opacity',1)),null!=c.settings.track&&c.settings.load_first_track&&(c.settings.random?u():_play('play next')),'play_track'==c.settings.obj.action||'play_tracks'==c.settings.obj.action){if(void 0!=c.settings.obj.init_track){var n=c.settings.obj.init_track;s=c.settings.obj.tracks[n].data('status'),a=c.settings.obj.tracks[n].attr('href'),('track_ready'==s||'already_onlist'==s)&&(c.settings.obj.tracks[0]=c.settings.obj.tracks[n])}for(var r=0;r<c.settings.obj.tracks_size;r++)if(s=c.settings.obj.tracks[r].data('status'),a=c.settings.obj.tracks[r].attr('href'),'track_ready'==s||'already_onlist'==s){var o=t('#'+c.settings.obj.list_id),l=o.attr('id'),d=null;if(null!==c.settings.track&&(e=c.settings.track.find('.sp-track-control').attr('href'),d=c.settings.track.attr('data-fromlist')),l!=d||o.hasClass('sp-ctrl')||void 0===c.settings.obj.list_id||(e=a),'track_ready'==s&&(e=null),e!=a){_destruct_sound();var g=t('#sp-queue-scroll').find('.sp-track-control[href="'+a+'"]');c.settings.track=g.parents('tr[class*="sp-track"]'),_play()}else _play();break}}c.settings.obj.status='ready'},v=function(){var s=c.settings.obj.track_nr,e=c.settings.obj.tracks[s].attr('href'),a=/http(s?):\/\/soundcloud/;if(!0==c.settings.base64){var n=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/;n.test(e)&&(e=Base64.decode(e))}if(!a.test(e))0<t('.sp-queue .sp-track-control[href="'+e+'"]').length?(c.settings.obj.tracks[s].attr('data-status','already_onlist'),h()):''!=e||'#'!=e||void 0!=e?(c.settings.obj.tracks[s].attr('data-status','file_exists'),_create_track()):(c.settings.obj.tracks[s].attr('data-status','Error404'),c.settings.play_from_list=!1,h());else if(0<t('.sp-queue .sp-track[data-sc="'+e+'"]').length){c.settings.obj.tracks[s].attr('data-status','already_onlist');var r=t('#sp-queue-scroll tbody .sp-track[data-sc="'+e+'"]');r=r.find('.sp-track-control').attr('href'),c.settings.obj.tracks[s].attr('href',r),h()}else _add_soundcloud()};_add_soundcloud=function(){var t=c.settings.obj.track_nr,s=c.settings.obj.tracks[t].attr('href');if(!0==c.settings.base64){var e=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/;e.test(s)&&(s=Base64.decode(s))}if(''==c.settings.client_id)return c.settings.obj.tracks[t].attr('data-status','Error404'),h(),!1;if(!c.settings.soundcloud)return c.settings.obj.tracks[t].attr('data-status','Error404'),h(),!1;if(void 0!=c.settings.obj.tracks[t].data('sc_stream')){var a={stream_url:null,artwork_url:null,title:null,permalink_url:null,user:{username:null,permalink_url:null}};return a.stream_url=c.settings.obj.tracks[t].data('sc_stream'),a.artwork_url=c.settings.obj.tracks[t].data('sc_art'),a.title=c.settings.obj.tracks[t].data('sc_title'),a.user.username=c.settings.obj.tracks[t].data('artist'),a.user.permalink=c.settings.obj.tracks[t].data('artist_url'),a.permalink=c.settings.obj.tracks[t].data('release_url'),_create_soundcloud(a),!1}SC.get('/resolve',{url:s},function(s){if(s==void 0||s.errors)c.settings.obj.tracks[t].attr('data-status','Error404'),h();else if(s.length!=void 0)s.tracks=s;else if(s.kind!=void 0&&'user'==s.kind)SC.get('/users/'+s.id+'/tracks',function(t){t.tracks=t,_process_sc_tracks(t)});else if(s.kind!=void 0&&'group'==s.kind)SC.get('/groups/'+s.id+'/tracks',function(t){t.tracks=t,_process_sc_tracks(t)});else if(s.tracks)_process_sc_tracks(s);else{var e=c.settings.obj.tracks[t].text();''!=e&&(s.title=e),_create_soundcloud(s)}})},_process_sc_tracks=function(s){var e=c.settings.obj.track_nr,a=c.settings.obj.tracks[e].attr('href'),n=[],r=c.settings.obj.tracks[e].attr('data-artist'),o=c.settings.obj.tracks[e].attr('data-artist_url'),l=c.settings.obj.tracks[e].attr('data-artist_target'),d=c.settings.obj.tracks[e].attr('data-release_url'),g=c.settings.obj.tracks[e].attr('data-release_target');shop_url=c.settings.obj.tracks[e].attr('data-shop_url'),shop_target=c.settings.obj.tracks[e].attr('data-shop_target'),free_download=c.settings.obj.tracks[e].attr('data-free_download'),!0==c.settings.base64&&(a=Base64.decode(a)),c.settings.obj.tracks.splice(e,1),--c.settings.obj.tracks_size,--c.settings.obj.track_nr,(shop_url==void 0||''==shop_url)&&(shop_url=''),(shop_target==void 0||''==shop_target)&&(shop_target=''),(free_download==void 0||''==free_download)&&(free_download=''),t.each(s.tracks,function(s,e){var u,p,k,_,m;u=void 0==r||''==r?e.user.username:r,o==void 0||''==o?(p=e.user.permalink_url,k='_blank'):(p=o,k=void 0==l||''==l?'_blank':l),d==void 0||''==d?(_=e.permalink_url,m='_blank'):(_=d,m=void 0==g||''==g?'_blank':g),!0==c.settings.base64&&(e.url=Base64.encode(e.url));var f='<a href="'+e.permalink_url+'" data-cover="" data-sc_list="'+a+'" data-sc_stream="'+e.stream_url+'" data-sc_art="'+e.artwork_url+'" data-sc_title="'+e.title+'" data-artist="'+u+'" data-artist_url="'+p+'" data-artist_target="'+k+'" data-release_url="'+_+'" data-release_target="'+m+'" data-shop_url="'+shop_url+'" data-shop_target="'+shop_target+'" data-free_download="'+free_download+'">'+e.title+'</a>';n.push(t(f))}),_insert_array_at(c.settings.obj.tracks,e,n),c.settings.obj.tracks_size+=n.length,h()},_insert_array_at=function(t,s,e){return Array.prototype.splice.apply(t,[s,0].concat(e)),t},_create_soundcloud=function(t){var s=c.settings.obj.track_nr,e=c.settings.obj.tracks[s].attr('href'),a=t.stream_url,n=c.settings.obj.tracks[s].attr('data-artist'),r=c.settings.obj.tracks[s].attr('data-artist_url'),o=c.settings.obj.tracks[s].attr('data-artist_target'),l=c.settings.obj.tracks[s].attr('data-release_url'),d=c.settings.obj.tracks[s].attr('data-release_target');return void 0===a?(console.log('Soundcloud error: No stream URL!'),c.settings.obj.tracks[s].attr('data-status','Error404'),h(),!1):void(a+=-1==a.indexOf('secret_token')?'?':'&',a=a+'consumer_key='+c.settings.client_id,(n==void 0||''==n)&&(n=t.user.username),(r==void 0||''==r)&&(r=t.user.permalink_url),(o==void 0||''==o)&&(o='_blank'),(l==void 0||''==l)&&(l=t.permalink_url),(d==void 0||''==d)&&(d='_blank'),!0==c.settings.replace_sc_covers?(c.settings.obj.tracks[s].attr('data-cover')==void 0||''==c.settings.obj.tracks[s].attr('data-cover'))&&c.settings.obj.tracks[s].attr('data-cover',t.artwork_url):c.settings.obj.tracks[s].attr('data-cover',t.artwork_url),!0==c.settings.base64&&(a=Base64.encode(a)),c.settings.obj.tracks[s].attr('data-sc',e),c.settings.obj.tracks[s].attr('href',a),c.settings.obj.tracks[s].attr('data-artist',n),c.settings.obj.tracks[s].attr('data-artist_url',r),c.settings.obj.tracks[s].attr('data-artist_target',o),c.settings.obj.tracks[s].attr('data-release_url',l),c.settings.obj.tracks[s].attr('data-release_target',d),c.settings.obj.tracks[s].text(t.title),_create_track())},_create_track=function(){c.settings.rebuild=!0;var s=c.settings.obj.track_nr,e=c.settings.obj.tracks[s].attr('href'),a=c.settings.obj.tracks[s].text(),n=c.settings.obj.tracks[s].data('cover'),r=c.settings.obj.tracks[s].data('artist'),o=c.settings.obj.tracks[s].data('artist_url'),l=c.settings.obj.tracks[s].data('artist_target'),d=c.settings.obj.tracks[s].data('release_url'),g=c.settings.obj.tracks[s].data('release_target'),u=c.settings.obj.tracks[s].data('shop_url'),p=c.settings.obj.tracks[s].data('shop_target'),k=c.settings.obj.tracks[s].data('free_download'),_=t(c.settings.track_html),m=null;if(t('.sp-queue .sp-track-control[href="'+e+'"]',c.el).length)return c.settings.obj.tracks[s].attr('data-status','already_onlist'),h(),!1;if(_.find('.sp-track-control').attr('href',e),(void 0==n||''==n)&&(n=c.settings.no_track_image),_.find('.sp-cover-artwork img').attr('src',n),_.find('.sp-title-button').text(a),(void 0!=d||''!=d)&&(_.find('.sp-title-button').attr('href',d),(void 0!=g||''!=g)&&_.find('.sp-title-button').attr('target',g)),void 0!=r&&''!=r&&(_.find('.sp-artist-button').text(r),(void 0!=o||''!=o)&&(_.find('.sp-artist-button').attr('href',o),void 0!=l&&''!=l&&_.find('.sp-artist-button').attr('target',l))),void 0!=u&&''!=u?(_.find('.sp-cart-button').attr('href',u),void 0!=p&&''!=p&&_.find('.sp-cart-button').attr('target',p),void 0!=k&&'yes'==k&&(_.find('.sp-cart-button').addClass('sp-download-button'),_.find('.sp-cart-button').attr('target',p),_.find('.sp-cart-button').attr('download',u))):_.find('.sp-cart-button').remove(),void 0!=c.settings.obj.list_id){var f=c.settings.obj.list_id;_.attr('data-fromlist',f).addClass('fromlist')}if(void 0!=c.settings.obj.tracks[s].data('sc')){var b=c.settings.obj.tracks[s].data('sc');_.attr('data-sc',b).addClass('sc-track')}if(void 0!=c.settings.obj.tracks[s].data('sc_list')){var v=c.settings.obj.tracks[s].data('sc_list');!0==c.settings.base64&&(v=Base64.encode(v)),_.attr('data-sc_list',v).addClass('sc-list')}c.settings.tracklist.append(_),m=c.settings.tracklist.find(_),c.settings.track_id++,c.settings.new_tracks_nr++,c.settings.tracklist_length=t('#sp-queue-scroll tbody .sp-track').length-1,0==c.settings.tracklist_length&&(c.settings.track=m),c.settings.obj.tracks[s].attr('data-status','track_ready'),m.find('.sp-track-control').on('click',y),m.find('.sp-remove-button').on('click',j),h()};var y=function(s){s.preventDefault(),c.settings.play_from_list=!1;var e=t(this).parents('tr[class*="sp-track"]');return e.hasClass('playing')||e.hasClass('paused')?(_play(),!1):(_destruct_sound(),c.settings.track=e,_play(),!1)},j=function(s){s.preventDefault();var e=t(this).parents('tr[class*="sp-track"]'),a=t(this).parents('tr[class*="sp-track"]').index(),n=null,r=!1;if(e.hasClass('playing')&&(r=!0),c.settings.sound&&(n=c.settings.sound.url),!0==c.settings.base64&&null!=n&&(n=Base64.encode(n)),0==c.settings.tracklist_length){if(_destruct_sound(),c.settings.track=null,c.settings.tracklist_length=null,C(0),'undefined'!=typeof Storage){var o=t('#sp-queue-scroll tbody').html();sessionStorage.setItem('scamp_player_list',o),null==c.settings.tracklist_length&&sessionStorage.removeItem('scamp_player_list')}return}if(n==e.find('.sp-track-control').attr('href')){var l=a+1,d=null;l>c.settings.tracklist_length&&(l=0),d=t('#sp-queue-scroll tbody tr:eq('+l+')'),r?(_destruct_sound(),c.settings.track=d,_play()):_destruct_sound()}if(C(a),c.settings.tracklist_length=t('#sp-queue-scroll tbody .sp-track').length-1,'undefined'!=typeof Storage){var o=t('#sp-queue-scroll tbody').html();sessionStorage.setItem('scamp_player_list',o),null==c.settings.tracklist_length&&sessionStorage.removeItem('scamp_player_list')}},C=function(s){return 0<t('#sp-scroller tr').length&&c.settings.tracklist.find('tbody tr:eq('+s+')').remove(),!1},w=function(){t('.sp-volume-slider').on('touchstart mousedown',function(s){if(!0===_has_touch()&&!1==c.settings.is_mouse)var a=!0;else var a=!1;if(null!=c.settings.tracklist_length){var e=t(this),n=e.find('.sp-volume-position'),d=e.offset().left,g=e.width(),u=c.settings.sound,p=null;return t(document).on('touchmove mousemove',function(t){var s=a?t.originalEvent.changedTouches[0]:t,e=r(0,o(s.clientX-d,g));return p=l(100*(e/g)),n.width(e),u&&u.setVolume(p),_set_vol_class(p),!1}).on('touchend mouseup',function(){return c.settings.volume=p,t(this).unbind('touchmove mousemove'),t(this).unbind('touchend mouseup'),!1}).trigger({type:'touchmove mousemove',clientX:s.clientX}),!1}}),t('.sp-progress').bind('touchstart mousedown',function(s){if(!0===_has_touch()&&!1==c.settings.is_mouse)var a=!0;else var a=!1;if(null!=c.settings.tracklist_length){var e=t(this).addClass('searching'),n=e.find('.sp-postion'),l=e.offset().left,d=e.width(),g=c.settings.sound;return c.settings.searching=!0,!1==a&&g&&(xPos=r(0,o(s.pageX-l,d)),n.width(xPos),g.setPosition(xPos/d*g.durationEstimate)),g.pause(),t(document).bind('touchmove mousemove',function(t){var s=a?t.originalEvent.changedTouches[0]:t,e=r(0,o(s.clientX-l,d));return n.width(e),g&&g.setPosition(e/d*g.durationEstimate),!1}).bind('touchend mouseup',function(){return c.settings.searching=!1,e.removeClass('searching'),c.el.hasClass('playing')&&g&&g.resume(),t(this).unbind('touchmove mousemove'),t(this).unbind('touchend mouseup'),!1}).trigger({type:'touchmove mousemove',clientX:s.clientX}),!1}})};_set_vol_class=function(s){0==s?t('.sp-volume-button').removeClass('sp-vol-medium sp-vol-max').addClass('sp-vol-off'):50>=s?t('.sp-volume-button').removeClass('sp-vol-max sp-vol-off').addClass('sp-vol-medium'):75<s&&t('.sp-volume-button').removeClass('sp-vol-medium sp-vol-off').addClass('sp-vol-max')},_format_time=function(t){var e=l(t/1e3),a=l(e/60),n=e-60*a;return a+':'+(10>n?'0'+n:n)},_pretty_link=function(s){var e='',a='',n=s.attr('href'),r=s.data('cover'),o=s.data('artist'),l=s.data('artist_url'),d=s.data('artist_target'),g=s.data('release_url'),u=s.data('release_target'),p=s.data('shop_url'),k=s.data('shop_target'),_=s.data('free_download');return void 0!=c.settings.link_filter&&''!=c.settings.link_filter&&t(s).find(c.settings.link_filter).length&&(a=t(s).find(c.settings.link_filter).text()),r=void 0==r||''==r?'':'data-cover="'+r+'"',o=void 0==o||''==o?'':'data-artist="'+o+'"',l=void 0==l||''==l?'':'data-artist_url="'+l+'"',d=void 0==d||''==d?'':'data-artist_target="'+d+'"',g=void 0==g||''==g?'':'data-release_url="'+g+'"',u=void 0==u||''==u?'':'data-release_target="'+u+'"',p=void 0==p||''==p?'':'data-shop_url="'+p+'"',k=void 0==k||''==k?'':'data-shop_target="'+k+'"',_=void 0==_||''==_?'no':'data-free_download="'+_+'"',e='<a href="'+n+'" '+r+' '+o+' '+l+' '+d+' '+g+' '+u+' '+p+' '+k+' '+_+'>'+a+'</a>',e=t(e),e},_add_track=function(s){if('#'==t(this).attr('href')||''==t(this).attr('href'))return!1;if('working'==c.settings.obj.status)return!1;var e=_pretty_link(t(this));c.settings.obj={status:'working',action:'add_track',tracks:[e],tracks_size:1,track_nr:-1},h(),s.preventDefault()},_play_track=function(s){if('#'==t(this).attr('href')||''==t(this).attr('href'))return!1;if('working'==c.settings.obj.status)return!1;if(t(this).parents('.sp-list')){var e=t(this).parents('.sp-list');if(e.attr('id')){if(!_check_tracks(e.attr('id'))){var a,n=t(this).parents('.sp-track-item');return t('.sp-track-item',e).each(function(s){if(n.is(t(this)))return a=s,!1}),_remove_tracks(e.attr('id')),_create_tracks(e.attr('id'),'play_tracks',a),!1}c.settings.play_from_list=!0}}var r=_pretty_link(t(this));if(c.settings.mobile)var o='add_track';else var o='play_track';c.settings.obj={status:'working',action:'play_track',tracks:[r],tracks_size:1,track_nr:-1},h(),s.preventDefault()},_add_tracks=function(s){var e=t(this).data('id');return void 0==e||''==e||0>=t('#'+e).length?!1:'working'!=c.settings.obj.status&&void(!_check_tracks(e)&&_remove_tracks(e),_create_tracks(e,'add_tracks',0),s.preventDefault())},_play_tracks=function(s){var e=t(this).data('id');return void 0==e||''==e||0>=t('#'+e).length?!1:'working'!=c.settings.obj.status&&void(!_check_tracks(e)&&_remove_tracks(e),_create_tracks(e,'play_tracks'),s.preventDefault())},_create_tracks=function(s,e,a){var n=t('#'+s),r=[],o=t('a.sp-add-track, a.sp-play-track',n).length;if(t('a.sp-add-track, a.sp-play-track',n).each(function(){r.push(_pretty_link(t(this)))}),c.settings.mobile&&'play_tracks'==e)var l='add_tracks';else var l='play_tracks';c.settings.obj={status:'working',action:e,list_id:s,init_track:a,tracks:r,tracks_size:o,track_nr:-1},h()},_debug=function(s){c.settings.debug&&t('#scamp-console').append(s+'<br>')};var x=function(s){t(s).bind('touchstart mousedown',function(s){if(!0===_has_touch()&&!1==c.settings.is_mouse)var a=!0;else var a=!1;if(null!=c.settings.tracklist_length){var e=t(this).addClass('searching'),n=e.find('.sp-content-postion'),l=e.offset().left,d=e.width(),g=c.settings.sound;return c.settings.searching=!0,g.pause(),!1==a&&g&&(xPos=r(0,o(s.pageX-l,d)),n.width(xPos),g.setPosition(xPos/d*g.durationEstimate)),t(document).bind('touchmove mousemove',function(t){var s=a?t.originalEvent.changedTouches[0]:t,e=r(0,o(s.clientX-l,d));return n.width(e),g&&g.setPosition(e/d*g.durationEstimate),!1}).bind('touchend mouseup',function(){return c.settings.searching=!1,e.removeClass('searching'),c.el.hasClass('playing')&&g&&g.resume(),t(this).unbind('touchmove mousemove'),t(this).unbind('touchend mouseup'),!1}).trigger({type:'touchmove mousemove',clientX:s.clientX}),!1}})};c.update_analyser=function(){a('update')},c.update_events=function(){x(t('.sp-content-control')),t('.sp-add-track').click(_add_track),t('.sp-play-track').click(_play_track),t('.sp-add-list').click(_add_tracks),t('.sp-play-list').click(_play_tracks)},c.update_content=function(s){var e=c.settings.track,a=null;null==e||(s==void 0&&(!0==c.settings.storage_play?s='loading':s='stop'),t('a.sp-play-track').removeClass('sp-play sp-pause sp-stop sp-loading'),t('.sp-content-control.sp-is-active').removeClass('sp-is-active'),a=e.hasClass('sc-list')?e.data('sc_list'):e.hasClass('sc-track')?e.data('sc'):e.find('.sp-track-control').attr('href'),t('a.sp-play-track[href="'+a+'"]').each(function(){var e=t(this);if(0<e.length){if('undefined'!=typeof e.data('control')){var a=e.data('control');if(a=t('#'+a),a.length){a.addClass('sp-is-active');var n=t('#scamp_player .sp-position')[0].style.width;a.find('.sp-content-position').css('width',n)}}'loading'===s?e.addClass('sp-loading'):'play'===s?e.addClass('sp-play'):'pause'===s?e.addClass('sp-pause'):'error'===s?e.addClass('sp-error'):'stop'===s?(e.addClass('sp-stop'),t('.sp-content-control.sp-is-active').removeClass('sp-is-active')):void 0}}))},c.addTrack=function(s,e){if('working'==c.settings.obj.status)return!1;if('undefined'==typeof s)return!1;var s=t('<a href="'+s.url+'" data-cover="'+s.cover+'" data-artist="'+s.artist+'" data-artist_url="'+s.artist_url+'" data-artist_target="'+s.artist_target+'" data-release_url="'+s.release_url+'" data-release_target="'+s.release_target+'" data-shop_url="'+s.shop_url+'" data-shop_target="'+s.shop_target+'" data-free_download="'+a[i].free_download+'">'+s.title+'</a>'),a=[s];return c.settings.obj={status:'working',action:e,tracks:a,tracks_size:1,track_nr:-1},h(),!1},c.addTracks=function(s,e){if('working'==c.settings.obj.status)return!1;if('undefined'==typeof s||0==s.length)return!1;for(var a,n=[],r=s.length,o=0;o<r;o++)a=t('<a href="'+s[o].url+'" data-cover="'+s[o].cover+'" data-artist="'+s[o].artist+'" data-artist_url="'+s[o].artist_url+'" data-artist_target="'+s[o].artist_target+'" data-release_url="'+s[o].release_url+'" data-release_target="'+s[o].release_target+'" data-shop_url="'+s[o].shop_url+'" data-shop_target="'+s[o].shop_target+'"  data-free_download="'+s[o].free_download+'">'+s[o].title+'</a>'),n.push(a);c.settings.obj={status:'working',action:e,tracks:n,tracks_size:r,track_nr:-1},h()},c.playerAction=function(t){return'working'!=c.settings.obj.status&&void('play'==t?_play():'pause'==t?_pause():'stop'==t?_():'next'==t?p():'prev'==t&&k())},function(){c.settings=t.extend({},d,e),c.el=s,window.soundManager&&(sm_obj={onready:function(){function s(){e?n=0:(n++,5<n&&(window.removeEventListener('mousemove',s,!1),c.settings.is_mouse=!0))}/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(c.settings.mobile=!0);var e=!1,n=0;if(window.addEventListener('mousemove',s,!1),window.addEventListener('mousedown',function(){n=0,e=!0},!1),window.addEventListener('mouseup',function(){e=!1,n=0},!1),c.settings.mobile&&(c.settings.autoplay=!1),c.settings.mobile&&null!=c.settings.path){function s(){if(t('a').off('click',s),!t('#scamp_player').hasClass('playing')&&!t('#scamp_player').hasClass('paused')){var e=soundManager.createSound({id:'init_mobile_track',url:c.settings.path+'/blank.mp3',autoload:!1,volume:100,onload:function(){},onplay:function(){},onpause:function(){},onresume:function(){},onstop:function(){},onfinish:function(){},whileloading:function(){},whileplaying:function(){}});e.play()}}t('a').on('click',s)}'undefined'!=typeof SC&&(SC.initialize({client_id:c.settings.client_id}),SC.whenStreamingReady(function(){c.settings.soundcloud=!0})),c.settings.sm_init=!0;var r=null;if(t('> a',c.el).length){r=[];var o=t('> a',c.el).length;t('> a',c.el).each(function(){r.push(t(this)),t(this).remove()})}if(c.el.append(c.settings.player_content),c.settings.track_html='<tr class="sp-track">\n<td><a class="sp-track-control sp-icon" href="#"></a></td>\n<td class="sp-cover-artwork"><img src="" alt="Cover" /></td>\n<td class="sp-title"><a class="sp-title-button"></a><a class="sp-artist-button"></a></td>\n<td class="sp-cart sp-small-screen"><a class="sp-icon sp-cart-button"></a></td>\n<td class="sp-remove sp-small-screen sp-medium-screen"><span class="sp-icon sp-remove-button"></span></td>',c.settings.tracklist=t('#sp-queue-scroll'),t('.sp-volume-position').css('width',c.settings.volume+'%'),_set_vol_class(c.settings.volume),c.settings.volume_user=c.settings.volume,!c.settings.mobile&&t('.sp-volume-button.sp-show-volume').length){var l=function(s){t('.sp-volume-bar-container').fadeToggle(200,'swing'),c.el.removeClass('sp-show-list'),t('body').removeClass('sp-show-list'),s.preventDefault(),s.stopPropagation()};t('.sp-volume-button').on('click',l),t(document).on('click',function(s){var e=t('.sp-volume-bar-container');e.is(s.target)||0!==e.has(s.target).length||(t('.sp-volume-button').off('click'),t('.sp-volume-bar-container').fadeOut(200,'swing',function(){t('.sp-volume-button').on('click',l)}))})}if('undefined'!=typeof Storage&&null!==sessionStorage.getItem('scamp_player_list')&&''!==sessionStorage.getItem('scamp_player_list')){c.settings.local_storage=!0;var d=sessionStorage.getItem('scamp_player_list'),u=0;t('#sp-queue-scroll tbody').html(d),t('#sp-queue-scroll tbody .sp-track-control').on('click',y),t('#sp-queue-scroll tbody .sp-remove-button').on('click',j),c.settings.tracklist_length=t('#sp-queue-scroll tbody .sp-track').length-1,t('#sp-queue-scroll .sp-track').removeClass('loading'),c.settings.mobile||!0!=c.settings.autoplay_storage?t('#sp-queue-scroll .sp-track').removeClass('loading paused playing'):t('#sp-queue-scroll .sp-track.playing').length?(c.settings.track=t('#sp-queue-scroll .sp-track.playing'),null!==sessionStorage.getItem('scamp_player_pos')&&(u=sessionStorage.getItem('scamp_player_pos')),g('play',u),c.settings.storage_play=!0):t('#sp-queue-scroll .sp-track.paused').length?(c.settings.track=t('#sp-queue-scroll .sp-track.paused'),null!==sessionStorage.getItem('scamp_player_pos')&&(u=sessionStorage.getItem('scamp_player_pos')),g('pause',u),c.settings.storage_play=!1):(c.settings.track=t('#sp-queue-scroll .sp-track:eq(0)'),g('pause',0),c.settings.storage_play=!1)}else if(null!==r){var _='add_tracks';c.settings.autoplay&&(_='play_tracks'),c.settings.obj={status:'working',action:_,tracks:r,tracks_size:o,track_nr:-1},h()}return t('.sp-play-button, .sp-next-button, .sp-prev-button').on('touchstart click',function(){c.settings.play_from_list=!1}),t('.sp-play-button').on('touchstart click',_play),t('.sp-next-button').on('touchstart click',p),t('.sp-prev-button').on('touchstart click',k),t('.sp-queue-button').on('touchstart click',function(s){c.el.toggleClass('sp-show-list'),t('body').toggleClass('sp-show-list'),s.preventDefault()}),t('#sp-toggle').on('touchstart click',function(t){c.el.toggleClass('sp-show-player'),t.preventDefault()}),t('#sp-empty-queue').on('touchstart click',function(s){c.settings.play_from_list=!1,(t('#sp-queue-scroll .sp-track.playing').length||t('#sp-queue-scroll .sp-track.paused').length)&&(_destruct_sound(),clearInterval(c.settings.shoutcast_timer)),t('#sp-queue-scroll .sp-track').not('.playing').remove(),c.settings.track=null,c.settings.tracklist_length=null,C(0),t('.sp-progress').find('.sp-position').width(0),t('.sp-progress').find('.sp-loading').width(0),t('.sp-content-control.sp-is-active').removeClass('sp-is-active'),'undefined'!=typeof Storage&&sessionStorage.removeItem('scamp_player_list'),s.preventDefault()}),w(),c.update_events('body'),c.el.addClass('sp-show'),void c.settings.onReady.call(void 0)},ontimeout:function(){},defaultOptions:{volume:c.settings.volume,usePeakData:!1}},t.extend(c.settings.sm_options,sm_obj),soundManager.setup(c.settings.sm_options))}()}})(jQuery);